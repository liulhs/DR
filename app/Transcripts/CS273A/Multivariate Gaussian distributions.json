[
    {
        "timestamp": "00:00:00",
        "text": "We'll examine the multivariate Gaussian distribution and some of its properties and geometry."
    },
    {
        "timestamp": "00:00:07",
        "text": "The Gaussian distribution in one dimension is a classic distribution over a single scalar random variable X and parameterized by a mean mu and a standard deviation sigma, or equivalently its variance, sigma squared."
    },
    {
        "timestamp": "00:00:15",
        "text": "The distribution is just given by an exponentiated quadratic, so there's a normalization constant that assures it integrates to 1, and then e to the minus 1 half times a quadratic form, X minus mu squared divided by the variance sigma squared."
    },
    {
        "timestamp": "00:00:22",
        "text": "This distribution has a classic bell-shaped curve."
    },
    {
        "timestamp": "00:00:30",
        "text": "It's symmetric."
    },
    {
        "timestamp": "00:00:37",
        "text": "Its mean is the center point, also the optimum of the maximum of the function."
    },
    {
        "timestamp": "00:00:45",
        "text": "And the variance tells us about the spread."
    },
    {
        "timestamp": "00:00:52",
        "text": "So the plus..."
    },
    {
        "timestamp": "00:01:00",
        "text": "or minus 2 sigma region will give us a 95% confidence interval."
    },
    {
        "timestamp": "00:01:06",
        "text": "So the larger sigma is, the wider this bell-shaped curve is."
    },
    {
        "timestamp": "00:01:13",
        "text": "Also useful, the classic maximum likelihood estimators."
    },
    {
        "timestamp": "00:01:20",
        "text": "Given some data, if we want to estimate the distribution, we can estimate the mean as being the empirical mean of the data points by taking the average of the data and estimate the variance as being the empirical average of the centered data points squared."
    },
    {
        "timestamp": "00:01:26",
        "text": "So we take x, subtract the empirical mean, square those points, and average them."
    },
    {
        "timestamp": "00:01:33",
        "text": "That'll give us the variance."
    },
    {
        "timestamp": "00:01:40",
        "text": "A multivariate Gaussian model is simply an extension of this model to vector-valued random variables."
    },
    {
        "timestamp": "00:01:46",
        "text": "So now x will be a vector with d values, and the distribution will be parameterized by a mean mu, which will also be a length d vector."
    },
    {
        "timestamp": "00:01:53",
        "text": "And a covariance matrix sigma, which will be a d by d matrix."
    },
    {
        "timestamp": "00:02:00",
        "text": "Again, it has the same kind of exponentiated quadratic form."
    },
    {
        "timestamp": "00:02:05",
        "text": "So here's a constant to ensure that the whole thing integrates to 1."
    },
    {
        "timestamp": "00:02:10",
        "text": "And then it's e to the minus 1 by 2."
    },
    {
        "timestamp": "00:02:15",
        "text": "And then instead of the x minus mu squared over sigma squared, we have x minus mu."
    },
    {
        "timestamp": "00:02:20",
        "text": "This is a row vector."
    },
    {
        "timestamp": "00:02:25",
        "text": "Sigma inverse, a d by d matrix, times x minus mu transpose."
    },
    {
        "timestamp": "00:02:30",
        "text": "So this is a column vector."
    },
    {
        "timestamp": "00:02:35",
        "text": "So a row times a square matrix times a column vector will give us a scalar number which evaluates to the probability of the value x."
    },
    {
        "timestamp": "00:02:40",
        "text": "This function, if plotted in the multiple dimensional features, say we have feature x1 and feature x2, this function will be, again, a bell-shaped curve, but now in two dimensions."
    },
    {
        "timestamp": "00:02:45",
        "text": "So here we have the same kind of symmetric bell-shaped mode."
    },
    {
        "timestamp": "00:02:50",
        "text": "If we take a single cut of this at some probability, we can plot it as a contour plot."
    },
    {
        "timestamp": "00:02:55",
        "text": "So here."
    },
    {
        "timestamp": "00:03:00",
        "text": "might be x1, here might be x2."
    },
    {
        "timestamp": "00:03:04",
        "text": "And the plot of constant probability will be an ellipse for a Gaussian."
    },
    {
        "timestamp": "00:03:08",
        "text": "So the mean vector mu will be a two-dimensional point in the center."
    },
    {
        "timestamp": "00:03:12",
        "text": "And the covariance will, again, define the spread and now the shape of this ellipsoidal function."
    },
    {
        "timestamp": "00:03:17",
        "text": "The maximum likelihood estimators are quite similar to the univariate case."
    },
    {
        "timestamp": "00:03:21",
        "text": "So the mean vector mu will now be the empirical average of the data vectors x."
    },
    {
        "timestamp": "00:03:25",
        "text": "So remember, mu is the same size as x."
    },
    {
        "timestamp": "00:03:30",
        "text": "So we just average the vectors."
    },
    {
        "timestamp": "00:03:34",
        "text": "The covariance matrix, sigma, will also be an empirical average."
    },
    {
        "timestamp": "00:03:38",
        "text": "We take the data and center them by removing the empirical mean."
    },
    {
        "timestamp": "00:03:42",
        "text": "And then what we average is the vector-vector product, so the outer product, x minus mu transpose times x minus mu."
    },
    {
        "timestamp": "00:03:47",
        "text": "The x minus mu transpose is a column vector."
    },
    {
        "timestamp": "00:03:51",
        "text": "x minus mu is a row vector."
    },
    {
        "timestamp": "00:03:55",
        "text": "And so their outer product."
    },
    {
        "timestamp": "00:03:59",
        "text": "product is a d by d matrix."
    },
    {
        "timestamp": "00:04:06",
        "text": "If we average those over all the data, we'll get the empirical covariance matrix sigma."
    },
    {
        "timestamp": "00:04:13",
        "text": "It's useful to see an example of this for independent variables x1 and x2."
    },
    {
        "timestamp": "00:04:19",
        "text": "If we have a variable x1 that's Gaussian, it'll have a normalization constant and then a Gaussian distribution with mean mu1 and variance sigma1 squared."
    },
    {
        "timestamp": "00:04:26",
        "text": "x2 being Gaussian means it has the same form, but say, with mean 2 and variance sigma2 squared."
    },
    {
        "timestamp": "00:04:33",
        "text": "If we now create a new vector variable, x, just by concatenating x1 and x2, we can ask what the distribution of x is."
    },
    {
        "timestamp": "00:04:40",
        "text": "We'll assume that x1 and x2 are independent, so that means their joint distribution is the product of their individual distributions."
    },
    {
        "timestamp": "00:04:46",
        "text": "And what we see is we get the product of their normalization constants times e to the minus 1 by 2."
    },
    {
        "timestamp": "00:04:53",
        "text": "And now, there'll be one term."
    },
    {
        "timestamp": "00:05:00",
        "text": "x1-mu1 over sigma1 squared, and another term, x2-mu2 squared over sigma2 squared, added together, since the product of these two things will add in the exponent."
    },
    {
        "timestamp": "00:05:20",
        "text": "If we just vectorize that, we can describe that as a x-mu, sigma inverse x-mu, where now x1-mu1 and x2-mu2 is given by the vector difference x-mu, and the scaling of the sigmas is accomplished by creating a diagonal covariance matrix."
    },
    {
        "timestamp": "00:05:40",
        "text": "So, sigma1 squared in the upper left, sigma2 squared in the lower right, and this inverse will simply be the same thing point-wise inverse, and when we multiply that by x-mu, transpose x-mu, we will get this term."
    },
    {
        "timestamp": "00:06:00",
        "text": "x1 minus mu1 over sigma 1 squared, and this term, x2 minus mu2 over sigma 2 squared, added together."
    },
    {
        "timestamp": "00:06:06",
        "text": "If we plot this on two features, we will find that this covariance matrix has an axis-aligned ellipsoidal shape, with the spread in the axis being proportional to the size of sigma."
    },
    {
        "timestamp": "00:06:13",
        "text": "So here I've drawn sigma 1, 1 being larger than sigma 2, 2."
    },
    {
        "timestamp": "00:06:20",
        "text": "So the spread in the x1 direction is larger than the spread in the x2 direction."
    },
    {
        "timestamp": "00:06:26",
        "text": "We'll see more examples of this later."
    },
    {
        "timestamp": "00:06:33",
        "text": "More generally, we can understand the geometry of the Gaussian through the eigendecomposition of the matrix sigma."
    },
    {
        "timestamp": "00:06:40",
        "text": "Consider a curve of constant probability."
    },
    {
        "timestamp": "00:06:46",
        "text": "The constant probability curve in a Gaussian means that the exponent will be constant, since the other terms are all just scalar normalization constants."
    },
    {
        "timestamp": "00:06:53",
        "text": "So this curve, this red curve."
    },
    {
        "timestamp": "00:07:00",
        "text": "is given by delta squared equal a constant, where delta squared is this exponentiated term."
    },
    {
        "timestamp": "00:07:10",
        "text": "So, x minus mu, sigma inverse, x minus mu transpose."
    },
    {
        "timestamp": "00:07:20",
        "text": "So, now let's understand what the shape of this function is by thinking about an eigendecomposition of the matrix sigma."
    },
    {
        "timestamp": "00:07:30",
        "text": "So, an eigendecomposition decomposes sigma into an eigenvector matrix mu, an eigenvalue matrix lambda that's diagonal, and the same eigenvector matrix mu transpose."
    },
    {
        "timestamp": "00:07:40",
        "text": "So, these mus are orthonormal vectors, which means that the product of mu i and mu j is either 0 if i is not equal to j, or 1 if i equals to j."
    },
    {
        "timestamp": "00:07:50",
        "text": "So, then we can envision this as sigma being a matrix U, which involves the eigenvectors in column-wise form."
    },
    {
        "timestamp": "00:08:00",
        "text": "a diagonal matrix lambda, and u transpose, which now has the same vectors but transposed."
    },
    {
        "timestamp": "00:08:10",
        "text": "If we now just define a variable y i as the projection of the vector x minus mu onto the ith eigenvector mu i."
    },
    {
        "timestamp": "00:08:20",
        "text": "So that projection is given by mu i transpose, mu i dot producted with x minus mu."
    },
    {
        "timestamp": "00:08:30",
        "text": "And then you can see that this delta squared has a very simple form in terms of these y's."
    },
    {
        "timestamp": "00:08:40",
        "text": "It's just y1 squared scaled by lambda 1 plus y2 squared scaled by lambda 2."
    },
    {
        "timestamp": "00:08:50",
        "text": "And this is precisely the equation of an ellipse with one axis of size 1 over lambda 1 and the other axis of size 1 over lambda 2."
    },
    {
        "timestamp": "00:09:00",
        "text": "lambda 1 and lambda 2."
    },
    {
        "timestamp": "00:09:12",
        "text": "Geometrically, this means that this ellipsoid of constant probability will be an ellipse with an axis in the u1 direction and an orthogonal axis in the u2 direction with the length of those axes being proportional to the eigenvalues or rather the square root of the eigenvalues associated with each eigenvector."
    },
    {
        "timestamp": "00:09:24",
        "text": "This eigen decomposition view can also be used in a constructive way to sample values of Gaussians."
    },
    {
        "timestamp": "00:09:36",
        "text": "I think this is a useful illustration of how this decomposition affects the shape of the Gaussian."
    },
    {
        "timestamp": "00:09:48",
        "text": "Let's start by generating random vectors X using the simple MATLAB randn function which gives us m samples of independent"
    },
    {
        "timestamp": "00:10:00",
        "text": "Gaussians of vectors of two features."
    },
    {
        "timestamp": "00:10:06",
        "text": "So this is a matrix of completely independent m by 2 entries of Gaussians with mean 0 and variance 1."
    },
    {
        "timestamp": "00:10:12",
        "text": "You can see that the data are independent."
    },
    {
        "timestamp": "00:10:18",
        "text": "They have a spherical shape and variance 1 in each direction."
    },
    {
        "timestamp": "00:10:24",
        "text": "We can then scale x by multiplying it by some matrix where this is the scaling term in the x1 feature."
    },
    {
        "timestamp": "00:10:30",
        "text": "This is the scaling term in the x2 feature."
    },
    {
        "timestamp": "00:10:36",
        "text": "So when we do that, we see that what happens is the x1 feature values get spread out."
    },
    {
        "timestamp": "00:10:42",
        "text": "The x2 feature values are not spread out because their scaling factor is 1."
    },
    {
        "timestamp": "00:10:48",
        "text": "And so now we have this elongated axis-aligned ellipse with a longer x1 feature than x2."
    },
    {
        "timestamp": "00:10:54",
        "text": "In mathematical terms, this thing where"
    },
    {
        "timestamp": "00:11:00",
        "text": "by is the square root of the eigenvector matrix on the previous slide."
    },
    {
        "timestamp": "00:11:15",
        "text": "We can then multiply by a rotation matrix, so here's a matrix that rotates by angle theta, and this is precisely taking the role of this eigenvector matrix U."
    },
    {
        "timestamp": "00:11:30",
        "text": "So this rotation is defining now the orthogonal axes, the first eigenvector and second eigenvector, U1 and U2."
    },
    {
        "timestamp": "00:11:45",
        "text": "Finally, if we add the same vector mu to all the data points, we'll shift the values, the center of those values, up so that they have average value mu instead of average value zero, and this will give us a Gaussian distribution with centered at the vector point mu, so mu1, mu2, and we"
    },
    {
        "timestamp": "00:12:00",
        "text": "with a covariance describing an ellipsoidal shape with value U lambda U transpose, where U transpose is this rotation matrix, and lambda is given by the square of this scaling matrix."
    },
    {
        "timestamp": "00:12:30",
        "text": "So this illustrates both how we can generate a collection of samples that are drawn from a multivariate Gaussian with arbitrary covariance matrix sigma, just by decomposing sigma into its eigen decomposition and then following this procedure, and also how to understand the geometry and what the role of the eigenvectors and eigenvalues are of the covariance matrix in determining the shape that this Gaussian ellipsoidal"
    },
    {
        "timestamp": "00:13:00",
        "text": "a contour takes on."
    },
    {
        "timestamp": "00:13:10",
        "text": "In summary, multivariate Gaussian distributions generalize the classic 1D Gaussian bell-shaped contour to vector-valued random variables by giving them a vector-valued mean of the same dimension as the data and a covariance matrix of size d squared that describes the shape and size of the bell-shaped mode."
    },
    {
        "timestamp": "00:13:20",
        "text": "For independent variables, we find that we have a diagonal covariance."
    },
    {
        "timestamp": "00:13:30",
        "text": "Diagonal covariance leads to an axis-aligned ellipsoidal shape."
    },
    {
        "timestamp": "00:13:40",
        "text": "If the diagonal entries are equal, that means that the size in each of these directions is the same, and we see that the contours take on a spherical shape."
    },
    {
        "timestamp": "00:13:50",
        "text": "More generally, for an arbitrary covariance matrix sigma, we get an ellipsoidal probability."
    },
    {
        "timestamp": "00:14:00",
        "text": "contour that may have some rotational shape, and you can understand the size and orientation of that ellipse by looking at the eigenvectors and the eigenvalues of the covariance matrix, with the eigenvectors defining the directions of the principal axes of this ellipse, and the scale determined by the value of the eigenvalues."
    },
    {
        "timestamp": "00:14:24",
        "text": "We can also follow this procedure in reverse to generate data from a multivariate Gaussian by first drawing data from independent unit normals, and then performing scaling and rotation and shifts to give us an arbitrary Gaussian."
    }
]